<div class = "holder">
  <div class = "container">
    <div class = "header">
      <div class = "icon">*️⃣</div>
      <div class="heading">Set new Password</div>
      <div class="description">Secure your account set up new password.</div>
    </div>
    <form class="form" (ngSubmit)="onSubmit()" #form="ngForm" novalidate>
      <div class="inputGroup">
        <input
          type="password"
          id="password"
          name="password"
          placeholder="Enter new password"
          required
          [(ngModel)]="password"
          #passwordInput="ngModel"
          (input)="validatePassword()"
          />
          @if ((passwordInput.touched || passwordInput.dirty) || (submitted && (!allPasswordValidationsMet() || passwordInput.invalid))) {
            <ul class="password-requirements"
              >
              <li [class.valid]="passwordValidations.length">Min 6 characters</li>
              <li [class.valid]="passwordValidations.upper">At least one uppercase letter</li>
              <li [class.valid]="passwordValidations.lower">At least one lowercase letter</li>
              <li [class.valid]="passwordValidations.number">At least one number</li>
              <li [class.valid]="passwordValidations.special">At least one special character</li>
            </ul>
          }
          @if ((passwordInput.invalid && (passwordInput.touched || passwordInput.dirty)) || (submitted && passwordInput.invalid)) {
            <div class="error"
              >
              @if (passwordInput.errors?.['required']) {
                <div>Password is required.</div>
              }
            </div>
          }
        </div>

        <div class="inputGroup">
          <input
            type="password"
            id="confirm-password"
            name="confirmPassword"
            placeholder="Re-enter new password"
            required
            [(ngModel)]="confirmPassword"
            #confirmPasswordInput="ngModel"
            />
            <!-- Show requirements when touched/dirty OR when submitted and passwords don't match -->
            @if ((confirmPasswordInput.touched || confirmPasswordInput.dirty) || (submitted && (!passwordsMatch || confirmPasswordInput.invalid))) {
              <ul class="requirements"
                >
                <li [class.valid]="confirmPassword.length > 0">Required</li>
                <li [class.valid]="passwordsMatch">Must match password</li>
              </ul>
            }
            @if ((confirmPasswordInput.invalid && (confirmPasswordInput.touched || confirmPasswordInput.dirty)) || (submitted && confirmPasswordInput.invalid)) {
              <div class="error"
                >
                @if (confirmPasswordInput.errors?.['required']) {
                  <div>Please confirm your password.</div>
                }
              </div>
            }
            @if ((confirmPassword && password && !passwordsMatch) && ((confirmPasswordInput.touched || confirmPasswordInput.dirty) || submitted)) {
              <div class="error"
                >
                Passwords do not match.
              </div>
            }

            <div class="submitButtonContainer">
              <button type="submit" class="submitButton"
                        [disabled]="
                        !allPasswordValidationsMet() ||
                        !passwordsMatch
                        ">
                Set new Password
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
<div *ngIf="isLoading" class="loading-overlay" role="status" aria-live="polite">
  <div class="loading-card">
    <div class="spinner"></div>
    <div class="loading-text">{{loading_message}}</div>
  </div>
</div>
<div class="otp-container">
  <div class="otp-card">
    <div class="header">
      <div class="icon">üîê</div>
      <div class="heading">Enter your Code</div>
      <div class="description">We sent code to {{email}}</div>
    </div>

    <form class="form" [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="input-group">
        <input
          id="digit1"
          type="text"
          class="otp-input"
          formControlName="digit1"
          maxlength="1"
          (input)="onInput($event, 'digit2')"
          />
          <input
            id="digit2"
            type="text"
            class="otp-input"
            formControlName="digit2"
            maxlength="1"
            (input)="onInput($event, 'digit3')"
            />
            <input
              id="digit3"
              type="text"
              class="otp-input"
              formControlName="digit3"
              maxlength="1"
              (input)="onInput($event, 'digit4')"
              />
              <input
                id="digit4"
                type="text"
                class="otp-input"
                formControlName="digit4"
                maxlength="1"
                (input)="onInput($event)"
                />
              </div>

              <div class="resend-section">
                Didn't receive code?
                <button
                  type="button"
                  class="resend-btn"
                  [disabled]="!canResend"
                  (click)="resend()"
                  >
                  @if (!canResend) {
                    <span>Resend in {{formattedTimer}}</span>
                  }
                  @if (canResend) {
                    <span>Click to Resend!</span>
                  }
                </button>
              </div>

              @if (!isFormValid() && form.touched) {
                <div class="requirement">
                  <span class="error-text">Please enter all 4 digits</span>
                </div>
              }

              <button
                type="submit"
                class="verify-btn"
                [disabled]="!isFormValid()"
                >
                Verify
              </button>
            </form>
          </div>
        </div>
